import requests
import time
import random
from database import DbService
from s3_move import move_files
from moniter import hit_moniter_api
from folder import create_folder
from custom_request import make_request_with_retry
from save_file import save_html_file
from settings import AWS, MYSQL
from bs4 import BeautifulSoup
import urllib.parse
import re
from urllib.parse import urlparse

folder_name = 'html'
create_folder(folder_name=folder_name)

local_path = f'./{folder_name}/'
s3_path = f"s3://{AWS['bucket']}/DATA/{AWS['source']}/{AWS['folder']}/"
move_files(local_path, s3_path)

#Update table
table_name = MYSQL['table']
procedure_name = MYSQL['procedure']
procedure_parameter = MYSQL['procedure_parameter']
column_name = 'company_number'
status_column = 'STATUS'

for _ in range(50):
    print('Script Started!')
    hit_moniter_api('kansas_moniter.json')
    time.sleep(random.uniform(3, 6))
    keyword = DbService().get_a_record(procedure_name, parameter=procedure_parameter)

    payload = f'__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=aY7LGcvEPlDKrCEovEWeWUT11Kjx8SE%2BBURC5%2BGf7umyqyrVzr1E3D%2BouwFGY%2BNr6oIU%2BnTSqH26owUnVXU6sktwvgdV3OGdKpvl%2B0pz1e9JzPJO7ozlVo86l8JJcblqRo%2BOhSPIdJEz8SJFt0tq8nTY%2F0ZO%2F6sKMKz5N%2FhiHoiGA50L12GFI4fQhhhWPBUCR0QzMMKr14QZy1F33%2FPoJQzrFtCe%2BpPKI9CBCb7BSZQvaC6CH1bpvmRRF%2BDDp40fqoCKkSZByY0mpZ8bf6EuruT8ZA%2FaAXdTdo7ojQNalQoOLLLSpbZR0xlodjhfSXExoBlXyGQTe0Ez4CY8iTpeMf%2FklQ2x%2BqVrF9WCVChDO8%2BqeOOw%2BGh7CVi06%2BDQ%2F2Dp5s3as2UtVqpYxQl5bAzwuYhpOo1N03Eo4mvHzOGKUdEggvVyxnObtJU9pVP0R37gOWPwDU81MeE43Jbb95WjK0o2w1hIlnU5Ju26kWt1ymnwXzNhStqVjy0oRq4bxyk%2B6bzlOMkATWto3YYaR7g7ubooeukvoesUWj45Efmd%2BsvAZawkbLDRSRfcdxWB5wQ4Ff22QtDDYdHqdKpNsnCrwXna3aiCOkefqYU7wzyLu3PXaBBR%2FaqvkmTs8DarFtqx180hQcGtlRKAGcU%2F8HikzbxwMjLr6RaggKFedFTFrE0ul38Oyqj0nW12RtDxR0%2FDGJi6CZCr2Fn2idWJXHEeaT8%2FQSe7NzJ0vrLg65Vn9wUdi%2BFusWt6r1Fd5CPZFcJVcMEi8L8wKVmTofF1QiwDLyZS5V6e749wyW6OxToZvpOf3CZSUL3ZN4zQRqOFSiTdb%2BWgjFBUjwU%2Fm3XDbd9K%2BM7NiQwG6PK8ZD69ZmcAzQhPcY1fZjhKyzONBhgxxeolD6uZDC7uPi4BRsl0igiY6hDbMQMDir5YvUHhf1T%2FFKu%2Bo%2FmJlXUvd%2BDZdpxOxBvtzzMVZdJkXVMl6lnCypcom27JwI3X1aC0ipsMgBN4l%2BUma%2FFbBkmPcIjk9uW%2BxtEMvmoPrUjwvdKi35RYrXWVOEiF5gwDAU8JrLET3h3wKr4Y52AO70CEWMZVwoRsLCUXM%2BSxp%2Bl86GcmF4%2BTVadtCPUX926GT7weA0Nj5h6mRz2s9sDl5X6qFBYvsphjUCMNtoCBP2IQrtYNofNL6mvtXDyx5DXsw%2FHiNUpJ2ROkeUaWrb0YNPnywjNVNb2mGE4G3xob9MBtbrZdRkFUS9%2FQE9pK9%2BNIxUTLkpvhvpr7zEayIA%2FautLbSghhmQPI62Kxy498DqKNyzZMPQQ0DALRsl5GpXyxLINXaKIqDWLrI4EMRSnYPpdlbWjSxbcsvLGQUfbueCN5pNhUpYzxfAEzXf0Pn11nlk1kxRSHEKm06HnJ3hX72Tk6Z5mveIJtmITuShY1aokrpvywa9gfId4YwX7L4VKxyr%2FBYRkPkFHFODYVDRJnCXIcp6EdCkG4R91sHqM%2FCpnnsao%2Bykrk4CxQGUQI0E2xpzJNFm2tlfAPTirDBF6CSyxXTIO75mlbY5XMXcRPU8k8P93XgA0x0uxYFJ61EYDEGKMPOZk1uZW3aP2fz21bUGyhprb00qteT6ojYeMMBljOObODKUZGm%2Fd81%2BKgByUrexoinXffzVZdKlvtmknI1ETDBZT9Yct8XQOjospVgDpPOLeKYOpmFgy3FgZW%2FjMQ35%2FgnOGVjRDFGLREKM2uRQVo9Sy3vhnmTVWx32F5MI9EdbfWaevdlh3RUrIr0sDcFzPEkOttzwQf%2F7OC8hT%2BWwlqhcUh9STkbiZc9QJJdfm9TgiWN5cY8aYUm96%2FzUEsdiUpbzkG3Z9zl%2FXj5vmkmMca34HFprz06jlW1DF5X%2BAJN1uo%2F3a82gB8A1GtmKqI0JgvLbrRDkfzTh934ExCFkrLomh0U5BQKanuOHWbRWxLUxRD67FSmOuhJ%2FDAQAC3IeNcQgU8inh%2FbA2ZbhcB5pREdHjrHg94JMYfECyy0joFuLH9gIh3a2a9sh1qpHbVK3panrU34aE7wdIFKAzQA0YO3MSkfCsUk13W6dFW0Myy3OVrsxEatONyojJSMmXrq%2Fypa0VoIhEsT1KtJLU2xNolPdIdl%2BctI7acKiUartGYTM1mtn1%2FZvvM4Y%2FJ54OuXqmneIdtdpavnV6YLGG03F6QFV78ccNxJfDPN7ClaGF8RzTC73HeTBGaPmcAVZgK0VUnWnoV%2BAoZz59XnbrewbkKD6cEBAyvo2ipgfEXDoW0Ky%2BhXt0bdBbXHB1PRnN20fhZsxxcaVV1h06nlwQQWCTrN7doDLnu1WSQ6LL%2BeNICwNHoUBDlXiIv3BCBLCo4GaYSaRmqHo%2BMr1tW6Jk8KBroGcawh3YmydUHMU%2B%2FGNVeL70reH1bbWPmxr0655RBqwIwZviRcqtBx5ZMtK1G9HoKSUPhMIYvInQmn0EDK1NWAffg79WOaOKh6JLUSsUWxiqERC1q9LZp%2FP3hW3KX8AIPWkicGzYmZdtOISTizWyak3Hmd%2BZknEZFJGmPSYJ3pO5SHWdpxAbZXCMD0GC3qbfI0I5Ta991EzvtjEoetHMXS%2Bwm7aopn9KMcLz6U0aGJzUpOTBxuDNYPCX2PGmXfkDd%2FWFBoP9wX1D%2FpMkLB4N8T8CO8PxkfnsMuABW4N6kAsBxeAC4DgUk%2FdZkswDGN1gZXzWMjg7%2FLpXthzs9Ty4%2BVVc%2BuEfU6CU6tB1bsQH2AorpZN4eTQ1g7Zs3eMQxyJhHlZ40Iayvnz42lSG2Dv8aLfizVkKgYPAhepIBWtgBl6Baa4OyPGrbKK9ez1qalW2lzfSbH6AD7qqnRFSP7Tk9ajbGKfZXuD6CGmetFuhylxOOJiwgDXYJlOdR3tVYhlaxrVgx5h4GKGJH5BWBkV02O%2BF4vga%2FVWFGF%2BcfC6fCWY4u2Pa9mLaJAU2a1Iq5TCa0MVG7RASkD10ph%2BT0I2JgEresjqIH1GKHgBsOjunAqYGDgWqt7KoM0jKHZl7h61yJQWobZIN6W7nB%2BcPDi6RQGt%2FtqDQ31DsZTXRc%2FkUua6ny4mNqmKSidwj0rllnnRs1%2BjtZ%2BSevShbTGBe7Xb%2FeTv7bUO7FSl0iI88yCYnqsO0w5VYiiGjCLQEPNpvW8t4QK0dl9fWpdO78Uhy%2FdD8jM1CQIo99oR509qgn3qKt2v%2Bsu5Qg82gE2saku6%2BPf1j24QQxh7UQk%2BcWDpp9ASLXMFGqxAXLi0SVYLMQu228xB39Thcu5u13jOmMxzYnHWqyKbHLjIE0Uj7nGWJRbIjSkmWSzheWc%2F4b7%2BPirASY%2F9tbbUEGkeLuTycOVD%2B6lf2uH9GeSaE%2BiLCJyhSBXVxaae78DHL%2BS5pYIByeP2DL3zvZeiL3qU34fd3D4LugrAJ6JHJZmAH5DORa1AWP3XqvBB1Q9l1BQ2jn1k%2FrFnAOot7umNrSaObNR%2FrYGjpWbl%2FaU6Jq9DB7xMWfzZEt5hDhWBXW4aAOdqrpY4rE3r1lxzBey4V0AYOduOS6qW0NgBI6St%2BXJYm45iZAZVXlkjiR6cyeqrLVKQvPrMCZOUae%2FinIWtlEB6G2mpkHkCzUt8qIClB4m%2BleM1hc8YzikoQ%2BnfVKopC73S4JrAqTrL60N1MB1F9ldt0HuCOQXx9nMeneATsqhR5YYoOftU5rFFjM4hQExmP70Huk%2B7VHbFT1zE%2BhhPIQ20k7sGJ%2Bv%2Braa5sr3AReeIHe%2FpP6i8xBnr7xoPArcozhgR1K8hUrMsvesxnJWj1eYmeGxPAD6ogYYL%2F9zQl2YJfZcJH5njfClXTXMHC3ihaM2HJOZjyZNfjeweAHE0emRxXe3wNEF%2BmYIJFcO5X2iZ8T09ab1ADbf3lAsFlEISMLlW6YhrsXN69XEGrJmTE3zTLrVAEFh8aKJ3NVAa558D9aLmAsLxSPzbfst32sx%2BLNLNuquAzuyXBcpOcV5SXpbiZUczOJibCVMb%2FE4o1mMS0xRB74Ti%2Ft0%2FXvrZ2An6sob%2FBRoPF7%2F8l5NoeFUd4dqjo0XYOiun3twegBHjC1Norqv1K7W%2FAUtl%2BsZHlDdFAn3xNfHxov3Kr6Vq2n7Sgj2LjrbJ%2F2%2BRMTQLIpRf8NIMuy1cTTMKalGQoKsZXE47bdvYtb2EnUhTqhkjvZWqoIKWeVu9f3JbhhkETo6l5LFtDHCTpDsc0DE%2BmC3N%2BlqfKo2ion0EsVEGhPMH6BS8gGnH8xP8Lr0XHpznT6A4VFT6VkZ18gI02YqKfg9%2FdBlKci85EoIbTOa1OBlKE94u251VAKLuMqYHo1tHuAIt%2FV4X%2BhmHlpVUjCy12e5VQSsrsJs03Kyjcqi8LRODF%2Bn2452fBR0910eyjwF4la64AblnenFUkUBxrdDR8ejM8vGqsWHnBQ5IYFOYX8kDEiXxl87O%2BgZz7YAUfR9%2BUw2SmPQAHud1SeYBe1Wv2DnLWqJp%2F2ZZkbuAl5xmkVeV%2FdgjX3Syd%2FUnQea1C%2BTE5Xf6ikJOr97BY5tp6tE0cmsLz44mumXjDlSTZMvObWKmJ27Q62OY7IxNjxsPvI0dFuYv7j63r082HJKIRFyp7KIpfh2rvf7RpkZSw3mQ6E4milvwOhCQkrp6ALy7btR0%2F63nscBSmnJ%2BsKZM68Q5WTkLNh3WY0pQeloMnyE%2BlmZq7Upda8V5V8cX4XudeNqgqhjmDfWKG7IianuMBLWt%2B4cfgBZuJIOX0XjfnB5znrcMkaglntq7JNDJREIkrPfJPI2MQqRhXqJdQ6L3ypLYjYUK%2FziSzh0bNhT3PUzUMJidaox9KYC05nkY4VmhiW9deVu6h17lqLEzsI0BimBn2y5I2%2FfJOabt0Zomiu0YpdWkXLy5HwlBw1%2B9MBQxVc3Ax%2BLERU5lD18iXMp015eVUQy%2BFmxkx3bkEvTmEkFXoicnvkmO%2BxY6o4luMCw%2BzDpM4EaCXkxiMtqBP1q3svaPrG8NpiW657QbOvbKeoyM%2FaItRf1H8BfP3J70sQ823%2FVVhD3Z2n5DCDeCAJ1JYWQrS2JyW47BbVXuMfvSCWyFf05XSbwBDcvDz9t%2FkVg1Wnt8Fd4pIzIIVElhu3IhI2EqsMp5cMJ3gXziUZicCVLcJbAcrltVXXVKYV60%2FE0NxmKokPAmlnpw%2F1Bhwf%2F%2FQuioXke0fmyiPzAMZw9G9Uu6QJud%2BzD0lD8yIFQr%2F9QGyTzOV4cKxO87xYMK1oQ0FCjJfNp4K%2BJD0%2FFZiw4KG3S8iqDcccEOUtYekKfQsdi3sjdFTnnuyIn7JI9lUUCTI0MbrUPNbmb7r0jAvMtGsuH2F4oaVhWtNO6QF6IhLpdUrJUTaa7j0eune7N18GQPumrI4kkjLO1SYee5kk1yzbOUoHytdPnsvll6QG4kMlypbh%2B5MdHebxHL9UKh0D%2BcOtJgJKC7IZbapTl52oaK3RvFhwF4URRWesAkvTF4BbTlTn2XJYXecGeeeUqbRsHXndMCCr2nIFTqibgPtvW0RgXSnMEyFq9t%2BTguY0MuMlhlpz34byL4ncVj4GC6hZ6v2WPbHdxfXlviKbv1v0wW5G7nW%2F45JVa3WyY6Its6Fh4GTjVEIQBlUgyi0As%2BNoE93avb0S3DUXeP%2FPIzF%2Bb74KFNB%2BHDJvyu5x0EGeZDzbmTPyEWpU8UQhR0aJyhkLhaVOYqK3iWw5iUQcIOLZpOYcNtETgZVjvDjafmi4yxXp3hWvtrfHyFRoj2MsktdX9PVIjkB6yh5nmso8dx7rwhgMI7XKwkj9JUbQg10HNkyxxK2PdDvgswONLnnqKmkhfTYQIatMuVg0rRF1yiKd%2FEWjNLV6aL0x8jacwVuh8T7kl37yU5%2F9ubnQDn6vCR%2F8MXr%2FloGX4yJ%2FlcD%2BoNw9f7mjQn0m3bMYzuvqHVqLHCzbwQRJiOFJk16Oy5YQE%2FWQNsH8%2BhP4voqP6u8f%2BPMqJ7ag%2FuKH2GZ4hRtCIJ8sTpl5wiZ6ZKT20Ajt9lyj4Xazj4%2BJuZXQOU6cNLldjU%2FfYtXbaEBkFPOdBzhdXxV6esFwGvqB0iI6MX775GBoc3APADyGZ0l3aBKqtusty%2F1%2BnSHAeVvCOCtHJBimzeXoAAn0a8as5FBXE5JJHvtdhJBnp5ib8heoAcStlEkYFeFsQsWU6wM3F7JGYA7dd%2BdZ0d41CusmHh8q1VVmc%2BE8BtlRXAyBkyWePXSxYt6lU5kfE5TJPtGNVhLsJ71%2BJcUBiARCn3E1xe4lHCcwnzpnRFDsa7%2FxMp0XQE5Eqm9s0OKmdlTksZKzlYbeEdJn2QwNDLgzX1O73%2Fx6EFDbxT66IXYeOih7%2FBt1Joh61T7P8oysHNJF5RjHouS4I986c2bdB2z2T5OOqm4hH0xSCt0oKl80x%2Fm%2FVtVJcmR9y%2F%2FciMhEk2Ah5MmyBKfuTJDVThiIDiZGMc0s9CLncYqZ2v5OMN5bt%2FYu7RAHQXml5IEvfJDy900zN8eH%2BYH2mpNldE4cD02TmoX2APEWHOWVEKP3zRkhJfhsUpt1uCC4NDuR0ZC07C9xS4Eco%2F%2FXZVIlrwiFX1dfgzTH%2Fm0ZeRECfMU3ctBQ4QFF5D%2FG8oosA6AcarixFBO1jFc0leNzY%2BvYQ0Y9Q0Ll1%2BYEpI4nx2u5YcCZln%2BNIY0R8lEA4b2BldGysvdWvvJrd88zqoMfOPiKgE8Xgrdc8UquPTJeA%2BkNGLltUyztfwvJSjTzRg6WCCbbSLjwhI7f0XuexJKlJnDXo9lAbyrReYggs1tZBBYyC1kaciT%2BwDisLVNpReBBw9T%2BeoCqxqOCUft9nUN9dLyx0ZL50bqBxzruQjiPLM5EbGPMqkrm88ILagagGVwwCMaUnnpdKnsskqSSSLTARcx%2BYnEsM%2BVZBNgQGJms%2Fl5ROuBOno%2Bi8yIoOzfh%2FXHXaRscgHlb1%2F9QI8qbchjY7Leg5A46EDf%2BIC9SBB8P97EdxbavlqQi%2FolM1b6GU7vrRQNtgqMUZDTbhhjIz9C4j%2FqjtYecMPChSTO5QMSr8IHc%2F1QPpDvCuNH1EyQWcF3c22GYOJNk6KEuPAZDIi1Mncgx9aC5XXmuH88F1FTdoZlfB9KM8W6Ade99%2F8ZIfg4IPd1Sj3bao4x7rFZkGblWAMT7iiukMkiDsYWivbjOKm5C0ycxfkUIfgoXRtCASKK7q5zfi7zXuvjR5GwNefQDi2RvBp2N5eAXyY2dDwCQIzUPWF1ae%2B%2BXw2zAW6pppZ4EeNUcAD6mE5qIQVmMAbAA0d4hRbQmA2pJBuWEan16PPPRCVOFTQFubv0OrjFTW2INNjGT1QtdXomNPOmgnEGGCB9%2Bj2G9wB0RRpvzv%2B7ChzZxgJGyf3Zdbe5IXvgHx4ztHwQ%2BTS%2FRDMwGvzYgTegwTGXGX6ZLUXK%2BB9%2BiFTy2S8ntPpxrAm3c6hmPn%2BOlCMmHIxQ3aUN9081MN66Ph8kZZ%2F%2FNrPkhyn02iudJOE1hclEIEIrrQYbR8e6Jen0Zp6PeApQBWIkU1JWE%2Fu1yAqK7BoDUvaga2MK7ZkvUFif2avuP4eTKjiwzyu%2BnOxj%2FPjSXyFfoTwU93b1NW2KzB9tI7VA8O%2FSqws9fbiZIt4%2BekShjsfHLMiXxI3LQcnJAK6XGmm8CgG5ZYBil8v87n59u3OZv7U%2FZuBEKaNPnove3qfcv9mNQ7kmNfPIzZmGRq0FP%2FQOI3HKVHJYzvwZOcb1VNQ9cNzCSuZg6f%2BcEtlQfRWRLvYqvsqymqRyGwpIe%2FGs%2FU2%2BZ5IGvMYay%2BOQ%2FNF6J3seaS7%2Fx2BEnPNJwEuau5QXZ9kYL9jdWDwZ8ywXF1LgULEyUy%2FqB%2FOSSk5aryaSu5XdlJnlx5lz035Z%2BdFiCNp2lKDWSSo0ZZv7%2B0IstcM3HtaXvAoGyGn64wWoqPGbTFjItWNLR%2BTnVFSblgKRP4NfTnR3xGtwVQTNwczMWwC8Gp%2BqX5QCNvRUjAhRvzRxsgoMYz6NZN68WoINuHXNUa6miYjDMWSkmN%2FLm8Xcy4CVU7KTc45wunNz1kckadumx%2BHU3Mp6IeoRDW4huwwZjVZezy4p1NIByITDT%2B1Bvgaco5YyekEULavJCbB%2FCbQ%2BQkqEhktKgueXqoGP8d%2B4uIIpYAYV1tyvoIQ4xbEcE9UdWOCmcp6Mgh10pXkQMnY4FKGRGxYglJVrcGbwv80TgHvgDW%2FeJYm6KGl3vkiOLDJI3zp%2F%2FeTZuV3C1nvqagFHrHFKl%2BFI8O%2FNYYR8ezDha62fQL8eV5oosDoeZmdOerHksrslHT6B%2BFnqVLFp6sparMKxJr9GDHiJtqjoV%2Bm1koz0Wb5giLGRYmEYnJhWPB%2Bo8PB77vdGgRLdAdR5pyLlRJX3HmevDTieUIkp%2BCoSU64qcjqQfAgXQwKrvI7KnfNznOJ5E2bQDchkWYv6JbjpEQwCpQoqy3IO9A1QPN1iWy2ea9Ot%2B6PcHtJoPhfEukGUJe8ok%2BjHeudpq41coe6UkZ44jAKceUWLutzSGcXJj1RUh6sWA1y7Znx%2BANz%2BGdUrIVnkDR7Z%2FvHAzXdfQlwtizNEQYw4DPgK1iXxefNmmDgujBN53JgSkzOqJT7JAmIeOBaV61eytvFs7Ht3s4ydlcru6u7ZBFOBr7Wc%2F%2BfXInH8fGGVfQABOHjjWDsXK5jT0AFmVcsfqeSy82T%2BFOTKJ2odkszMNyL2lOTjS5hT9RrIRFogHWtuTeko0GDL3fwjcA3ycLhJfeA1hrS9wolrJf%2BODzyn0jdJKALvKCjyyZq7QAeXNR25B2JSrWm5A%2FtFWegOYYuK%2Fhu1Q0yXXmEMqk0uNIVQUMrRRK2IAMVuXF9QEWl4v0lrqX08zgnye3lvilObmVp6MZ6710K35INUR4fLHOASJyhEVXdOLkiDVafpLfgFCNH7a8sjQCdBS5VCAizUBvZh%2FBLwERl%2BwgYKEwvUbxtqRaqHi0TiDSnzULkFBNalqKcLqWv0C%2FnKgQdoxboEJSJgdC%2BF2N7u3nT17U9RnNQu%2FM367Nd6DlBTmtmZYVDREHdNntuSTrIndxTT%2Fw%2BwKyB3gITWYZAJbB5LZanXWfDTF7OyzWCEazK%2BpCpzDC%2FnMg8x6KzinVe595qITb0vvCPilJJuC8J%2FuwP2WM08GCFK6QMrfE4xjFNttEMksKtE8vcTLj7W2chjZazxmuR2F7GppWwb9earnaXU3Y0RP3eQb9jlsMJeC7kP%2F%2BzjsFEfkdWJmObPEkpe7JhUq%2FVLeRSr2lnalS50P4JOf82%2BdHX%2BW92idUTpeHSTH3fZxaJQmLPHbrW%2FJuWQgr9zuZMp9pMyLH5eqYUidL59irmZ2RcpqoAGw0JAx19EKNNbtiqiqxdESLnoDJaZabGGbrcC0qUId47wZWa7hWkmRldvqKqFj75XXLrGYrGat6LrNsHT17YTfJtf7IVHIOcDGwf5f3B1vlC1%2Bb3ZpK%2Fo12HqHTGuRtIk%2BcD1H8yzqGtWNFKmRWMvFBwX%2BqrDTzddsxLFYw%2BzkKgIQ0onBkvStWg1BuoBz6BJ%2BIWEBNEb8E4HmVkI5GJ6DSFr1jcG20NZs2cjhA2Y7SggrlWyAeUN7%2FUJogK%2FfA0OpSXQMvBQBLXuo5MifBaRivgSc1T3UuGNUWRgwJVgdSPeXhwZPOsx1KYObHP58ImOJflhF2kfLNN0A9vS5h%2BqzkCWsE3n1%2Fnk12XqqRBenPBj74%2FYFT1JxejW4SVCMIjkh%2BiGot0BVjn3EYaRpNPOi05dnxci1dGzckaxdUNfBgLtauScJOF7x3e%2BfvmEu5dOQZzsvXrFg%2BZctewjXJONvcSnDKoodOiBRb5BuTvJKJ3d1PSEEJU52Wo7pn9Hb2RYnw1AGns6BipJ6ZjWa4Qy0iyQXIqg7gw1%2BkfIdfefJ76dWbPm6FLVRjkfGRHmzkcS7PWHyohlFybXFBWPjuFmxfBMCI6D9DANT5dva%2FBfbq%2BnB7WeOg2u25vh0JkajqY77a6TC12EqZssTHXX48rIc1zrGHVoLMiZqSPSuHRoWCQ2eg2XdOLFv3AKmbtvyywHRHqmra5fNAVgnzxYq1Y6QMTxu4CXKlMqmU99SOMjjq8Mw7DjMC7GIyukyssQjYj%2B%2FQqWmyd3agHpulwT76hL2ZkHlpLCmhvo3XgJklMKACRDKNqMM02JR6iG5qj1VdJkLMiGEMC%2B3iy5I6RebKV%2FfJqvav3XTm8rbdOO04TFoK5mkst1%2BuvDOcENuE6xhCJe2fvBUezcjKQPaCJi%2FHu07ATsXpJIOEkhTx%2FWNGmYVk7V94Sg4qXrKsY5vbQqvQNbKkmC0oDYhSpp5Fsnl7PPy%2BhTEUI7gKGr6hb5hOunj1R9a38%2FNrbYU79EPLMPTCyvD72czMUJKGd0dkzGFAk27BPUpebGd5dws20VfFb1m8%2Fab0XgxEUATsB3q83U8HLEk%2F%2B576WTf6IM0Rormcsy8hp%2Bn2gVDfP%2FqON%2FZBmfVdmZvsJTRI9I4J1g1vJR%2FXogm2x2JKY5O6kwnUbTPkwypVHog%2FsPpbMDCDZ2zPJudW8d2eOV4ClJV368ZFT%2FO8LUEAg7gi5MOk0GZPgEV9xcNNmFLG4DE9SDlVBwPVfZm09PiGOCtBs9jhGaiLzw1ZxKM98V6hS9Z8Ab09ePxj3WXg8dF39FIAOQt%2FhviFyDdhbSj2CU%2BdpUjZBnLbLTbTnLjbs%2FpLvCK%2Bvbj2ItOUX%2BXjuhpCbaI0vA%2F%2FvXLDrWWV8JwL4zyYZxdvbqYAbf2JwWeMIRrXYWAH%2BuyCGR4%2BlcVFTwMzuKsSrco0tSM0%2B3H%2BzoJsryHMi6GxD5fpnEd9ogwIhcgLnG4y99uC0RGE41GH36j%2BjUPqfm%2Fzwc6rIY0f1FqVN2sh%2FPuqqUyzR0UNip1SXRSulME10gDKozw5aZI&__VIEWSTATEGENERATOR=1BF965EF&__EVENTVALIDATION=WxE0ux7oX19R3ayYVSrpUJcj0u5RckMJbKKUXdoaH5ArLMg9J5638wxRBH4H8GZPxnkTUkYb51t7e44YRaozgBvHLy648eyAsL1uI8GkPUCM1S5Bbnl2PLc%2Fvx9Rfnic3VkDRAJjbjZKE25ZQOq%2FJ8nSYNj8LqO6XYcqyOFl%2F894Sx%2B0RHxj4V77waO%2FEURa%2FD0BFNiHIC0rmTiVCieiC756vczAAJwN3WYkIoHOTMfY%2FoG1v%2Bz4gHizFC32b%2Bf%2FqOBqO3YpQ4a4ilYzmYEayGJCoLqyPQuJwNNFvTchQpcm6UXPTaf%2B3YFzGi2REYTNcNxZHZuI%2FL7Ur60ttcjs6y%2FCkJnX%2B5th09r0iOm3viUC2PkBUVI%2Fqy%2F7rBjwaKGWxc9Mifqwh6nMQH42QPusqeDj7D8jgq19cZcIm5yP1xhGKWQQkKf9UbBQG9KXLsNEaAkK2r7q%2FQ4Z%2FDvGNA1FQPJeIGfcRau30qBZ3sQEoWui65q8zfytL1eqgpgipR2ZxeJIhKpbl9Yke%2B1xXW27t%2FO5fUTQ2M0s1%2FC7Xd2G7KSOBQp8oj54lAnzu0WTOouhl7%2BDkGtiYcDF0trqYRO%2BDe4nQxafP8xqs6WJDZvovWM3avv3wyYKfsyF91qczer3NFqG1OPY9TfN%2BIAHA0RQE6pw3MigVtYPM3w23uDagNz4p3TEtPBop8oEHJ9eu%2FbAlO%2B76jYv%2FPAscPM5mUAOgGT1Sf2POKshNNGlpX7dZX9NPyI%2FHaR5YFD8%2FD7mp%2Fx%2B4SfNpZCMcuPw8zpSETSWBB%2BbvqyxQ96CR9T%2FPYYMWAJazVxY21kwmLj4iZBCUKrIhu491a5AmX6gemTaSXxdfqDiAV4ntZuHgCyfqwXCL837acouduSpMl6vqz1TDXtbhnrV%2BtC%2F2ZI6p85w%2FSpR5V9OEjNgylUdgOg5N8nqrGHCnkfgpedruPKsryRtvy%2BuyAubbwXch3yyZLDJHHmquggXCkatToZDFBB2Nqi1WCf%2BEAemI9Wu8Ma1t49hYmt0kvtaiQ8HvDbgMSuxKol0j%2BfWx69lfc8OpHGUP7DnZjIfsW10mNPg3yBLKRWMPmzkYi0U393m2SxTmvz7NI4ketRVszGWCyCqYO%2F%2FT7PHJ7WsYwbjg4oODSTVzHhiuXSprwe%2FnLpiyKIXm%2FQi2hMMH937KrHRfj5%2FMnkkykjmQy0%3D&ctl00%24MainContent%24rblSearchType=ID&ctl00%24MainContent%24txtSearchEntityID={keyword}&ctl00%24MainContent%24btnSearchEntity=Search&ctl00%24MainContent%24hdnSelectedTab=generalInfo'
    headers = {
    'authority': 'www.sos.ks.gov',
    'method': 'POST',
    'path': '/eforms/BusinessEntity/Search.aspx',
    'scheme': 'https',
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
    'Accept-Encoding': 'gzip, deflate, br, zstd',
    'Accept-Language': 'en-US,en;q=0.9',
    'Cache-Control': 'max-age=0',
    'Content-Type': 'application/x-www-form-urlencoded',
    'Origin': 'https://www.sos.ks.gov',
    'Priority': 'u=0, i',
    'Referer': 'https://www.sos.ks.gov/eforms/BusinessEntity/Search.aspx',
    'Sec-Ch-Ua': '"Chromium";v="124", "Google Chrome";v="124", "Not-A.Brand";v="99":',
    'Sec-Ch-Ua-Mobile': '?0',
    'Sec-Ch-Ua-Platform': '"Windows"',
    'Sec-Fetch-Dest': 'document',
    'Sec-Fetch-Mode': 'navigate',
    'Sec-Fetch-Site': 'same-origin',
    'Sec-Fetch-User': '?1',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36'
    }

    result_response = make_request_with_retry(url = "https://www.sos.ks.gov/eforms/BusinessEntity/Search.aspx", session=requests, method='post', headers=headers, data=payload, max_retries=5, retry_delay=3)
    time.sleep(random.uniform(3, 6))

    print(result_response.text)
    if keyword in result_response.text:
        save_html_file(folder_name=folder_name, keyword=keyword, html_content=result_response.text)
        DbService().update_the_record(status =10, table=table_name, column=column_name, status_column=status_column,  keyword=keyword)
    else:
        print("No data or error")
        DbService().update_the_record(status =5, table=table_name, column=column_name, status_column=status_column,  keyword=keyword)
    time.sleep(random.uniform(3,12))
    
move_files(local_path, s3_path)



